CREATE DATABASE TRAINING;
USE TRAINING;
CREATE TABLE CUSTOMERS(
CUSTOMER_ID INT,
FIEST_NAME VARCHAR(20),
LAST_NAME VARCHAR(20),
PACKAGE_ID INT,
PRIMARY KEY(PACKAGE_ID)
);

CREATE TABLE PACKAGE(
PACKAGE_ID INT REFERENCES CUSTOMERS(PACKAGE_ID),
SPEED VARCHAR(10),
SECTOR_ID INT
);

CREATE TABLE SECTOR(
SECTOR_ID INT,
SECTOR_NAME VARCHAR(20)
);
INSERT INTO CUSTOMERS VALUES(1, 'JOHN', 'CRITOPH', 20),
(2, 'NIKI', 'SHARMA', 80),
(3, 'PRIYA', 'MAHTO', 40),
(4, 'PREETHI', 'P', 60);
SELECT * FROM CUSTOMERS;

INSERT INTO PACKAGES VALUES(20, '50GB', 500),(40, '70GB', 600),(60, '100GB', 600),(80, '200GB', 500);
SELECT * FROM PACKAGES;

INSERT INTO SECTORS VALUES(500, 'PRIVATE'),(600, 'BUSINESS');
SELECT * FROM SECTORS;

SELECT CUST.CUSTOMER_ID, CUST.FIEST_NAME, CUST.LAST_NAME, PACK.SPEED, SEC.SECTOR_NAME
FROM CUSTOMERS CUST JOIN PACKAGE PACK
ON CUST.PACKAGE_ID = PACK.PACKAGE_ID
JOIN SECTOR SEC ON SEC.SECTOR_ID = PACK.SECTOR_ID;

SELECT CUST.CUSTOMER_ID, CUST.FIEST_NAME, CUST.LAST_NAME, PACK.SPEED, SEC.SECTOR_NAME
FROM CUSTOMERS CUST JOIN PACKAGE PACK
ON CUST.PACKAGE_ID = PACK.PACKAGE_ID
JOIN SECTOR SEC ON SEC.SECTOR_ID = PACK.SECTOR_ID
WHERE SEC.SECTOR_NAME = 'BUSINESS';

-- BY CUTOMER ID 
SELECT CUST.CUSTOMER_ID, CUST.FIEST_NAME, CUST.LAST_NAME, PACK.SPEED, SEC.SECTOR_NAME
FROM CUSTOMERS CUST JOIN PACKAGE PACK
ON CUST.PACKAGE_ID = PACK.PACKAGE_ID
JOIN SECTOR SEC ON SEC.SECTOR_ID = PACK.SECTOR_ID
WHERE SEC.SECTOR_NAME = 'BUSINESS'
ORDER BY CUSTOMER_ID;

SELECT SEC.SECTOR_NAME, COUNT(*)
FROM CUSTOMERS CUST JOIN PACKAGE PACK
ON CUST.PACKAGE_ID = PACK.PACKAGE_ID
JOIN SECTOR SEC ON SEC.SECTOR_ID = PACK.SECTOR_ID
GROUP BY SEC.SECTOR_NAME
ORDER BY COUNT(*);
