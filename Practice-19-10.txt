CREATE DATABASE TRAINING;
USE TRAINING;

-- NON PARAMETERIZED FUNCTION
DELIMITER $
CREATE FUNCTION HELLO()
RETURNS VARCHAR(50)
DETERMINISTIC
BEGIN
RETURN "HELLO WORLD FROM USER";
END $
DELIMITER ;
SELECT HELLO() ;

-- PARAMETERIZED FUNCTION
DELIMITER $
CREATE FUNCTION SHOWNAME(FIRST_NAME VARCHAR(20), LAST_NAME VARCHAR(20))
RETURNS VARCHAR(40)
DETERMINISTIC
BEGIN
RETURN CONCAT(FIRST_NAME, LAST_NAME);
END$
DELIMITER ;
SELECT SHOWNAME('PREETHI','KUMARI');
SELECT HELLO();

-- FUNCTION DOING WORK
DELIMITER $
CREATE FUNCTION ADDITION(NUMBER_ONE INT, NUMBER_TWO INT)
RETURNS INT 
DETERMINISTIC
BEGIN
RETURN NUMBER_ONE + NUMBER_TWO;
END$
DELIMITER ;
SELECT ADDITION(10, 20) AS 'ADD';

DELIMITER $
CREATE FUNCTION CALCULATEAGE(DOB DATE)
RETURNS INT
DETERMINISTIC
BEGIN
DECLARE TODAY_DATE DATE;
SELECT CURRENT_DATE() INTO TODAY_DATE;
RETURN YEAR(TODAY_DATE) - YEAR(DOB);
END $
DELIMITER ;
SELECT CALCULATEAGE('1995-07-20') AS 'AGE';

SELECT * FROM CUSTOMERS;

-- STORED PROCEDURE
DELIMITER $
CREATE PROCEDURE GETBOOKANDISSUEDATE()
BEGIN
SELECT * FROM BOOKS;
SELECT * FROM ISSUED;
END $
DELIMITER ;
 
CALL GETBOOKANDISSUEDATE();
 
--  PARAMETRIZED STORED PROCREDURE WITH IN(INPUT) PARAMETER
DELIMITER $
CREATE PROCEDURE GETBOOKNAMFROMID(IN ID VARCHAR(10))
BEGIN
SELECT BOOK_NAME FROM BOOKS WHERE BOOKS.BOOK_ID = ID;
END $
DELIMITER ;
CALL GETBOOKNAMFROMID('T0002');

-- PARAMETRIZED STORED PROCEDURE WITH OUT(OUTPUT) PARAMETER
DELIMITER $
CREATE PROCEDURE GETBOOKSRECORDSFROMID(OUT REC VARCHAR(10))
BEGIN
SELECT COUNT(*) INTO REC FROM BOOKS WHERE BOOK_ID = 'C0001';
END $
DELIMITER ;
CALL GETBOOKSRECORDSFROMID(@REC);
SELECT @REC AS TOTALRECORDS;

-- PARAMETRIZED STORED PROCEDURE WITH IN(INPUT) AND OUT(OUTPUT) PARAMETER
DELIMITER $
CREATE PROCEDURE GETBOOKNAMEANDRECORDFROMID(IN NAME VARCHAR(10), OUT RECORD VARCHAR(10))
BEGIN
SELECT COUNT(*) INTO RECORD FROM BOOKS WHERE BOOK_ID = 'C0001';
END $
DELIMITER ;
CALL GETBOOKNAMEANDRECORDFROMID('FAST COOK', @RECORD);
SELECT @RECORD AS RECORDS;

-- VIEW CREATION
SELECT * FROM BOOKS;
CREATE VIEW BOOKSVIEW AS SELECT BOOK_ID, BOOK_NAME, AUTHOR_NAME FROM BOOKS;
SELECT * FROM BOOKSVIEW;




